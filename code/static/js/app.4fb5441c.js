(function(t){function e(e){for(var s,o,r=e[0],l=e[1],c=e[2],d=0,f=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],s=!0,r=1;r<n.length;r++){var l=n[r];0!==i[l]&&(s=!1)}s&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var s={},i={app:0},a=[];function o(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=s,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(n,s,function(e){return t[e]}.bind(null,s));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var s=n("85ec"),i=n.n(s);i.a},"50b5":function(t,e,n){},5147:function(t,e,n){"use strict";var s=n("50b5"),i=n.n(s);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"header"}),n("div",{staticClass:"content"},[n("ControlBar",{attrs:{userlist:t.userList},on:{change:t.changeUser}}),n("msg-content",{attrs:{msglist:t.msgList,title:t.to},on:{send:t.sendMsg,image:t.sendImage}})],1)])},a=[],o=(n("a15b"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("1276"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("MsgList",{attrs:{list:t.msglist,title:t.title}}),n("InputArea",{on:{send:t.sendMsg,image:t.image}})],1)}),r=[],l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"inputW"},[n("transition",{attrs:{name:"textIn"}},[n("TextInput",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],attrs:{"text-content":t.textContent},on:{textChange:t.textChange}})],1),n("button-list",{attrs:{flag:t.flag},on:{upMsg:t.toggleShow,downMsg:t.toggleShow,clearMsg:t.clearText,sendMsg:t.sendText,image:t.image}})],1)},c=[],u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"butW"},[n("transition",{attrs:{name:"buttonU"}},[n("button",{directives:[{name:"show",rawName:"v-show",value:!t.flag,expression:"!flag"}],staticClass:"inputBtn el-icon-edit upBtn",on:{click:t.uptext}})]),n("transition",{attrs:{name:"buttonI"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],staticClass:"inputBtn el-icon-picture-outline imageBtn"},[n("input",{ref:"InputFile",staticClass:"inputW",attrs:{type:"file"},on:{change:function(e){return e.stopPropagation(),t.select(e)}}})])]),n("transition",{attrs:{name:"buttonS"}},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],staticClass:"inputBtn el-icon-upload2 sendBtn",on:{click:t.sendtext}})]),n("transition",{attrs:{name:"buttonC"}},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],staticClass:"inputBtn el-icon-delete clearBtn",on:{click:t.cleartext}})]),n("transition",{attrs:{name:"buttonD"}},[n("button",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],staticClass:"inputBtn el-icon-bottom downBtn",on:{click:t.downtext}})])],1)},d=[],f={name:"ButtonList",props:["flag"],methods:{uptext:function(){this.$emit("upMsg")},downtext:function(){this.$emit("downMsg")},cleartext:function(){this.$emit("clearMsg")},sendtext:function(){this.$emit("sendMsg")},select:function(t){console.log(this.$refs.InputFile.files[0]);var e=this.$refs.InputFile.files[0],n=new FormData;n.append("file",e),console.log(n);var s="/upload",i={headers:{"Content-Type":"multipart/form-data"}},a=this;this.$axios.post(s,n,i).then((function(t){console.log(t.data),a.$emit("image",t.data)}))}}},m=f,h=(n("5e86"),n("2877")),g=Object(h["a"])(m,u,d,!1,null,"78d9d9fa",null),p=g.exports,v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"textW"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"},{name:"focus",rawName:"v-focus"}],class:{active:t.isActive},attrs:{placeholder:"Text Something Here..."},domProps:{value:t.text},on:{focus:function(e){t.isActive=!0},blur:function(e){t.isActive=!1},input:function(e){e.target.composing||(t.text=e.target.value)}}})])},x=[],w={name:"TextInput",props:["textContent"],data:function(){return{text:"",isActive:!1}},methods:{},mounted:function(){this.text=this.textContent},directives:{focus:{inserted:function(t){t.focus()}}},watch:{text:function(){this.$emit("textChange",this.text)},textContent:function(){this.text=this.textContent}}},b=w,C=(n("74ae"),Object(h["a"])(b,v,x,!1,null,"73a066e5",null)),y=C.exports,_={name:"InputArea",components:{ButtonList:p,TextInput:y},data:function(){return{flag:!1,textContent:""}},methods:{toggleShow:function(){this.flag=!this.flag},textChange:function(t){this.textContent=t},clearText:function(){this.textContent=""},sendText:function(){""!==this.textContent&&(this.$emit("send",this.textContent),this.textContent="")},image:function(t){console.log(t),this.$emit("image",t)}}},I=_,L=(n("9b62"),Object(h["a"])(I,l,c,!1,null,"194e1f71",null)),M=L.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"msglist"},[n("div",{staticClass:"chatHeader"},[t._v(t._s(t.title))]),n("div",{directives:[{name:"resize",rawName:"v-resize",value:t.wresize,expression:"wresize"}],ref:"cc",staticClass:"msg"},[n("el-scrollbar",{ref:"scrollbar",staticStyle:{height:"100%"}},[n("ul",{staticClass:"list"},[n("div"),n("transition-group",{staticClass:"msgW",attrs:{name:"show"}},[t._l(t.list,(function(e,s){return["user"===e.type?[n("li",{key:s},[n("div",{staticClass:"msgItem"},[n("div",{staticClass:"msgImf"},[n("div",{staticClass:"user"},[t._v(t._s(e.from))]),n("div",{staticClass:"time"},[t._v(t._s(e.time))])]),n("div",{staticClass:"msgContent"},[n("p",{domProps:{innerHTML:t._s(e.content)}})])])])]:t._e(),"sys"===e.type?[n("li",{key:s,staticClass:"sysL"},[n("div",{staticClass:"sysMsg"},[n("p",[t._v(t._s(e.content))])])])]:t._e(),"my"===e.type?[n("li",{key:s,staticClass:"myL"},[n("div",{staticClass:"myItem"},[n("div",{staticClass:"myContent"},[n("p",{domProps:{innerHTML:t._s(e.content)}})])])])]:t._e()]}))],2)],1)])],1)])},O=[],$={name:"MsgList",props:["list","title"],data:function(){return{}},methods:{wresize:function(){this.$refs.scrollbar.update(),this.goDown()},goDown:function(){var t=this.$refs.cc.querySelectorAll("li");0!==t.length&&t[t.length-1].scrollIntoView(!1)}},updated:function(){this.$refs.scrollbar.update(),this.goDown()},directives:{resize:{bind:function(t,e){var n=0;function s(){var s=document.defaultView.getComputedStyle(t);n!==s.height&&e.value(),n=s.height}t.__interval=setInterval(s,20)},unbind:function(t){clearInterval(t.__interval)}}}},T=$,k=(n("5996"),Object(h["a"])(T,N,O,!1,null,"af61b66c",null)),S=k.exports,j={name:"MsgContent",components:{InputArea:M,MsgList:S},props:["msglist","title"],data:function(){return{}},methods:{sendMsg:function(t){this.$emit("send",t)},image:function(t){console.log(t),this.$emit("image",t)}}},B=j,U=(n("6582"),Object(h["a"])(B,o,r,!1,null,"6c4aa997",null)),P=U.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-row",[n("el-col",{staticClass:"control hidden-xs-only"},[n("div",{staticClass:"wrapper"},[n("div",{staticClass:"userInf"},[n("div",{staticClass:"userName"},[t._v("用户名")]),n("div",{staticClass:"online"},[n("div",{staticClass:"listName"},[t._v("在线列表")]),n("div",{staticClass:"onlineList"},[n("ul",t._l(t.userlist,(function(e,s){return n("li",{key:s,staticClass:"userItem",attrs:{"data-id":e},on:{click:t.change}},[t._v(t._s(e))])})),0)])])])])])],1)},A=[],z={name:"ControlBar",props:["userlist"],methods:{change:function(t){console.log(t.target.dataset.id),this.$emit("change",t.target.dataset.id)}}},K=z,D=(n("5147"),Object(h["a"])(K,E,A,!1,null,"52e1992a",null)),F=D.exports,J={components:{MsgContent:P,ControlBar:F},data:function(){return{wsLINK:null,userName:"",msgList:[],userList:[],to:"all",userIndex:[{name:"all",list:null}]}},methods:{sendMsg:function(t){console.log(t);var e=new Object;e.type="sendText";var n=new Object;n.to=this.to,n.content=t.toString(),e.data=n,this.wsLINK.send(JSON.stringify(e))},sendImage:function(t){console.log(t);var e=window.location.href+t;console.log(e);var n='<a href="'+e+'" target="_blank" style="text-decoration: none;color: inherit;font-size: 14px;">[ Click To Open File ]</a>';this.sendMsg(n)},close:function(){var t={type:"logout"};this.wsLINK.send(JSON.stringify(t))},onMsg:function(t){var e=JSON.parse(t.data),n=new Object;switch(e.type){case"system":n.type="sys",n.content=e.data.content,this.msgList.push(n);break;case"reciveText":this.addMsg(e.data);break;case"reciveFile":break;case"iLogin":1e4===e.data.status?(n.type="sys",n.content="登陆成功，欢迎来到聊天室",this.msgList.push(n)):(n.type="sys",n.content="登陆失败，请刷新重试",this.msgList.push(n));break;case"login":n.type="sys",this.userList=e.data.userList,n.content=e.data.userName+" 进入了聊天室",this.msgList.push(n);break;case"logout":n.type="sys",this.userList=e.data.userList,n.content=e.data.userName+" 离开了聊天室",this.msgList.push(n);break}},changeUser:function(t){t!==this.userName?(this.saveUser(),this.loadUser(t)):(this.saveUser(),this.loadUser("all"))},saveUser:function(){for(var t=this,e=0;e<t.userIndex.length;e++)if(t.userIndex[e].name===t.to)return t.userIndex[e].list=t.msgList,void console.log("保存"+t.to);var n={name:"",list:[]};n.name=t.to,n.list=this.msgList,this.userIndex.push(n),console.log("新建并保存"+t.to)},loadUser:function(t){var e=this;e.to=t;for(var n=0;n<e.userIndex.length;n++)if(e.userIndex[n].name===t)return void(e.msgList=e.userIndex[n].list);e.msgList=[]},addToUser:function(t,e){if(e===this.to)this.msgList.push(t);else{for(var n=this,s=0;s<n.userIndex.length;s++)if(n.userIndex[s].name===e)return void n.userIndex[s].list.push(t);var i={};i.name=e,i.list=[],i.list.push(t),n.userIndex.push(i)}},addMsg:function(t){console.log(t);var e={};if(t.from===this.userName)e.type="my",e.content=t.content,console.log(t.to),this.addToUser(e,t.to);else{e.type="user",e.content=t.content,e.from=t.from;var n=t.time.split(" ");e.time=n[1],"all"!==t.to?(this.addToUser(e,t.from),console.log("add to "+t.from)):this.addToUser(e,"all")}},getTime:function(){var t=new Date,e=t.toTimeString().split(" ")[0];return e},uuid:function(t,e){var n,s,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=[];if(e=e||i.length,t)for(n=0;n<t;n++)a[n]=i[0|Math.random()*e];else for(a[8]=a[13]=a[18]=a[23]="-",a[14]="4",n=0;n<36;n++)a[n]||(s=0|16*Math.random(),a[n]=i[19===n?3&s|8:s]);return a.join("")}},created:function(){var t=prompt("请输入用户名","user"+this.uuid(8,16)),e="ws://"+document.domain.toString()+":12580";console.log(e),this.wsLINK=new WebSocket(e),this.userName=t,this.wsLINK.onmessage=this.onMsg;var n=this;n.wsLINK.addEventListener("open",(function(){var t={type:"login",data:{userName:n.userName}};n.wsLINK.send(JSON.stringify(t))}))},mounted:function(){var t=this;window.addEventListener("beforeunload",(function(e){return t.close()}))},destroyed:function(){var t=this;window.removeEventListener("beforeunload",(function(e){return t.close()}))}},W=J,H=(n("034f"),Object(h["a"])(W,i,a,!1,null,null,null)),V=H.exports,q=n("bc3a"),G=n.n(q),Q=(n("e2f3"),n("450d"),n("06f9")),R=n.n(Q),X=(n("2986"),n("14e9")),Y=n.n(X),Z=(n("bdc7"),n("aa2f")),tt=n.n(Z),et=(n("de31"),n("c69e")),nt=n.n(et),st=(n("a769"),n("5cc3")),it=n.n(st),at=(n("a673"),n("7b31")),ot=n.n(at),rt=(n("adec"),n("3d2d")),lt=n.n(rt),ct=(n("f4f9"),n("c2cc")),ut=n.n(ct),dt=(n("7a0f"),n("0f6c")),ft=n.n(dt),mt=(n("1951"),n("eedf")),ht=n.n(mt);s["default"].use(ht.a),s["default"].use(ft.a),s["default"].use(ut.a),s["default"].use(lt.a),s["default"].use(ot.a),s["default"].use(it.a),s["default"].use(nt.a),s["default"].use(tt.a),s["default"].use(Y.a),s["default"].use(R.a);n("e05f"),n("845f");s["default"].prototype.$axios=G.a,new s["default"]({render:function(t){return t(V)}}).$mount("#app")},5996:function(t,e,n){"use strict";var s=n("f339"),i=n.n(s);i.a},"5e86":function(t,e,n){"use strict";var s=n("9168"),i=n.n(s);i.a},6582:function(t,e,n){"use strict";var s=n("d542"),i=n.n(s);i.a},"74ae":function(t,e,n){"use strict";var s=n("d4ec"),i=n.n(s);i.a},"845f":function(t,e,n){},"85ec":function(t,e,n){},9168:function(t,e,n){},9359:function(t,e,n){},"9b62":function(t,e,n){"use strict";var s=n("9359"),i=n.n(s);i.a},d4ec:function(t,e,n){},d542:function(t,e,n){},f339:function(t,e,n){}});
//# sourceMappingURL=app.4fb5441c.js.map